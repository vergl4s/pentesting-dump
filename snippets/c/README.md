## C snippets

### Run bytecode

```c
#include <sys/mman.h>
#include <string.h>

int main ()
{
  /*                                                              
        mov rax, 60          ; sys_exit
        mov rdi, 2
        syscall                                                   
  */
  char code[] = {
    0x41,0x41,0x41,0x41
  };

  void *buf;

  /* copy code to executable buffer */    
  buf = mmap (0,sizeof(code),PROT_READ|PROT_WRITE|PROT_EXEC,
              MAP_PRIVATE|MAP_ANON,-1,0);
  memcpy (buf, code, sizeof(code));

  /* run code */
  ((void (*) (void))buf)();

  return 0;
}
```


### Invoke bash

```c
#include <stdio.h>
int main(void){
    setuid(0);
    setgid(0);
    seteuid(0);
    setegid(0);
    execvp("/bin/sh", NULL, NULL);
}
```
